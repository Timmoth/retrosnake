(()=>{"use strict";var t;!function(t){t[t.Up=1]="Up",t[t.Down=2]="Down",t[t.Left=3]="Left",t[t.Right=4]="Right"}(t||(t={}));const e=function(){function e(){var e=this;this.lastDirection=t.Up,this.directions=[],window.addEventListener("keydown",(function(i){"ArrowUp"===i.key?(e.directions.push(t.Up),i.preventDefault()):"ArrowDown"===i.key?(e.directions.push(t.Down),i.preventDefault()):"ArrowLeft"===i.key?(e.directions.push(t.Left),i.preventDefault()):"ArrowRight"===i.key&&(e.directions.push(t.Right),i.preventDefault())}))}return e.prototype.getDirection=function(){return this.directions.length>0?this.lastDirection=this.directions.shift():this.lastDirection},e}(),i=function(){function e(t,e,i,h,s,o){this.game=t,this.x=h,this.y=s,this.prev=e,this.next=null,this.direction=o,this.flipConnectorSegment=!0,this.index=i}return e.prototype.update=function(t){var e,i=this.nextPosition(),h=i[0],s=i[1];this.x=h,this.y=s,null===(e=this.next)||void 0===e||e.update(this.direction),this.direction=t},e.prototype.drawHead=function(e){var i=this.nextPosition(),h=i[0],s=i[1],o=this.game.toPixelCoord(h,s),l=o[0],n=o[1];switch(this.direction){case t.Up:e.fillRect(l,n+this.game.cellHeight/2,this.game.cellWidth/2,this.game.cellHeight/2),e.fillRect(l+this.game.cellWidth/2,n+this.game.cellHeight/2,this.game.cellWidth/2,this.game.cellHeight/2),e.fillRect(l,n+this.game.cellHeight/2,this.game.cellWidth/2,this.game.cellHeight/2);break;case t.Down:e.fillRect(l,n,this.game.cellWidth/2,this.game.cellHeight/2),e.fillRect(l+this.game.cellWidth/2,n,this.game.cellWidth/2,this.game.cellHeight/2);break;case t.Left:e.fillRect(l+this.game.cellWidth/2,n,this.game.cellWidth/2,this.game.cellHeight/2),e.fillRect(l+this.game.cellWidth/2,n+this.game.cellHeight/2,this.game.cellWidth/2,this.game.cellHeight/2);break;case t.Right:e.fillRect(l,n,this.game.cellWidth/2,this.game.cellHeight/2),e.fillRect(l,n+this.game.cellHeight/2,this.game.cellWidth/2,this.game.cellHeight/2)}},e.prototype.drawBody=function(t){var e=this.game.toPixelCoord(this.x,this.y),i=e[0],h=e[1];this.index%2==0?t.fillRect(i,h,this.game.cellWidth,this.game.cellHeight):(null!==this.prev&&(this.flipConnectorSegment=this.prev.direction==this.direction?this.prev.flipConnectorSegment:!this.prev.flipConnectorSegment),this.flipConnectorSegment?(t.fillRect(i,h,this.game.cellWidth/2,this.game.cellHeight/2),t.fillRect(i+this.game.cellWidth/2,h+this.game.cellHeight/2,this.game.cellWidth/2,this.game.cellHeight/2)):(t.fillRect(i,h+this.game.cellHeight/2,this.game.cellWidth/2,this.game.cellHeight/2),t.fillRect(i+this.game.cellWidth/2,h,this.game.cellWidth/2,this.game.cellHeight/2)))},e.prototype.drawTail=function(e){var i=this.nextPositionReverse(),h=i[0],s=i[1],o=this.game.toPixelCoord(h,s),l=o[0],n=o[1];switch(this.direction){case t.Up:e.fillRect(l,n,this.game.cellWidth/2,this.game.cellHeight/2);break;case t.Down:e.fillRect(l,n+this.game.cellHeight/2,this.game.cellWidth/2,this.game.cellHeight/2);break;case t.Left:e.fillRect(l,n,this.game.cellWidth/2,this.game.cellHeight/2);break;case t.Right:e.fillRect(l+this.game.cellWidth/2,n,this.game.cellWidth/2,this.game.cellHeight/2)}},e.prototype.draw=function(t){var e;this.drawBody(t),null===this.prev&&this.drawHead(t),null===this.next&&this.drawTail(t),null===(e=this.next)||void 0===e||e.draw(t)},e.prototype.nextPosition=function(){var e=this.x,i=this.y;switch(this.direction){case t.Up:i--;break;case t.Down:i++;break;case t.Left:e--;break;case t.Right:e++}return[e,i]},e.prototype.nextPositionReverse=function(){var e=this.x,i=this.y;switch(this.direction){case t.Up:i++;break;case t.Down:i--;break;case t.Left:e++;break;case t.Right:e--}return[e,i]},e.prototype.grow=function(){if(null===this.next){var t=this.nextPositionReverse(),i=t[0],h=t[1];this.next=new e(this.game,this,this.index+1,i,h,this.direction);var s=this.next.nextPositionReverse();i=s[0],h=s[1],this.next.next=new e(this.game,this,this.next.index+1,i,h,this.direction)}else this.next.grow()},e.prototype.Collides=function(t,e){return this.x==t&&this.y==e||null!==this.next&&this.next.Collides(t,e)},e}(),h=function(){function t(t){this.game=t}return t.prototype.move=function(){for(this.moveToRandomPosition();this.x!=this.game.snake.x&&this.y!=this.game.snake.y;)this.moveToRandomPosition();console.log("food position: (".concat(this.x,",").concat(this.y,")"))},t.prototype.moveToRandomPosition=function(){this.x=Math.floor(Math.random()*(this.game.horizontalCellCount-1)),this.y=Math.floor(Math.random()*(this.game.verticalCellCount-1))},t.prototype.draw=function(t){var e=this.game.toPixelCoord(this.x,this.y),i=e[0],h=e[1];i-=1,h-=1;var s=(this.game.cellWidth+2)/3,o=(this.game.cellHeight+2)/3;t.fillRect(i+s,h,s,o),t.fillRect(i+s+s,h+o,s,o),t.fillRect(i+s,h+o+o,s,o),t.fillRect(i,h+o,s,o)},t}(),s=function(){function t(t,i){this.width=t,this.height=i,this.food=new h(this),this.input=new e,this.cellWidth=12,this.cellHeight=12,this.headerHeight=70,this.borderThickness=10,this.horizontalCellCount=(t-2*this.borderThickness)/this.cellWidth,this.verticalCellCount=(i-this.headerHeight-2*this.borderThickness)/this.cellHeight,this.lastTimeStamp=0,this.setup()}return t.prototype.toPixelCoord=function(t,e){return[this.cellWidth*t+this.borderThickness,this.cellHeight*e+this.headerHeight+this.borderThickness]},t.prototype.update=function(t){var e;t-this.lastTimeStamp<=Math.max(this.speed,100)||(this.lastTimeStamp=t,this.snake.update(this.input.getDirection()),this.snake.Collides(this.food.x,this.food.y)&&(this.speed-=5,this.snake.grow(),this.food.move(),this.score++),(null===(e=this.snake.next)||void 0===e?void 0:e.Collides(this.snake.x,this.snake.y))?this.gameOver("Snake eat itself"):this.snake.x<0?this.gameOver("Snake hit west wall"):this.snake.x>=this.horizontalCellCount?this.gameOver("Snake hit east wall"):this.snake.y<0?this.gameOver("Snake hit north wall"):this.snake.y>=this.verticalCellCount&&this.gameOver("Snake hit south wall"))},t.prototype.draw=function(t){t.strokeRect(this.borderThickness,this.borderThickness+this.headerHeight,this.width-2*this.borderThickness,this.height-this.headerHeight-2*this.borderThickness),t.beginPath(),t.moveTo(this.borderThickness-1,this.headerHeight),t.lineTo(this.width-this.borderThickness+2,this.headerHeight),t.stroke(),this.food.draw(t),this.snake.draw(t),t.font="48px pixel",t.fillStyle="black",t.textBaseline="top",t.fillText(String(this.score).padStart(4,"0").toString(),this.borderThickness,this.borderThickness)},t.prototype.gameOver=function(t){console.log("Game over!"),console.log("------------------"),console.log(t),console.log("Score: ".concat(this.score)),console.log("------------------"),this.setup()},t.prototype.setup=function(){this.score=0,this.speed=150;var t=Math.floor(Math.random()*(this.horizontalCellCount-1)),e=Math.floor(Math.random()*(this.verticalCellCount-1));this.snake=new i(this,null,0,t,e,this.input.getDirection()),this.snake.grow(),this.food.move()},t}();window.addEventListener("load",(function(){var t=this.document.getElementById("canvas1");if(null==t)throw new Error("Could not find canvas.");var e=t.getContext("2d");e.imageSmoothingEnabled=!1,t.width=500,t.height=500;var i=new s(t.width,t.height);t.onkeydown=function(t){"ArrowUp"!==t.key&&"ArrowDown"!==t.key||t.view.event.preventDefault()},function h(s){e.fillStyle="#94d300",e.clearRect(0,0,t.width,t.height),e.lineWidth=4,e.fillStyle="#131903",i.update(s),i.draw(e),requestAnimationFrame(h)}(0)}))})();